{% extends "base.html"%}

{% block scripts %}
  {{super()}}
  <script src="/static/js/trackVolunteerHours.js"></script>
{% endblock %}

{% block styles %}
  {{super()}}
{% endblock %}

{% block app_content %}

  <h1 align="center">{{program.programName}}</h1><br>
  <h3 align="center">{{eventParticipantsData[0].event.eventName}}</h3><br>

  <div class="btn-group">
    <ul class="nav nav-tabs">
      <li class="nav-item">
        <a class="nav-link" href="https://google.com">Event Form</a> <!--FIXME: link to event page-->
      </li>
      <li class="nav-item">
        <a class="nav-link active" aria-current="page" href="#">Track Hours</a>
      </li>
    </ul>
  </div>

  <form action="#" method="post"><br>

    <label class='d-none' id="eventLength">{{eventLength}}</label>
    <input  class="form-control" id="eventID" name="event" value="{{eventParticipantsData[0].event}}" type='hidden'>


    <div class="ui-widget input-group">
      <input id="trackHoursInput" type="input" placeholder="Search">
      <span class="input-group-text" style="padding:0 0 0 0rem;"><i class="bi bi-search" style="margin-left:-35px;"></i></span>
      <div><button type="button" class="btn btn-secondary btn-sm" data-bs-toggle="modal" data-bs-target="#addVolunteerModal">
          <i class="bi bi-plus-circle"></i>
      </button></div>
    </div>

  <!-- Modal -->
  <div class="modal fade" id="addVolunteerModal" tabindex="-1" aria-labelledby="addVolunteerModalLabel" aria-hidden="true" style="width:-60px;">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Add a volunteer</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="input-group">
            <div class="form-outline ui-widget">
              <input type="input" id="addVolunteerInput" class="form-control" placeholder="Search"  oninput="searchTrackHoursVolunteers()" />
            </div>
            <button type="button" class="btn btn-primary btn-sm"><i class="bi bi-search" style="margin-left:0px;"></i>
            </button>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button id="selectVolunteerButton" type="button" class="btn btn-primary">Add participant</button>
        </div>
      </div>
    </div>
  </div>


    <div>
      <table class="table">

        <thead>
          <tr>
            <th>Present</th>
            <th>Name</th>
            <th>Email</th>
            <th>Phone Number</th>
            <th>RSVP</th>
            <th>Total Hours</th>
          </tr>
        </thead>
      <tbody id="volunteerTable">

      {% for participant in eventParticipantsData%}
      <tr>
        <td><input type="checkbox" id='checkbox_{{participant.user.username}}' name="checkbox_{{participant.user.username}}"
                   onChange='toggleTrackHoursInputBox(this)' {% if participant.attended == 1 %} checked  {%endif%}></td>

        <td><input class="form-control" type='hidden' name="username{{loop.index|string}}" id="{{participant.user.username}}"value="{{participant.user}}"> {{participant.user.firstName}} {{participant.user.lastName}}</td>
        <td>{{participant.user.email}}</td>
        <td>{{participant.user.phoneNumber}}</td>

        <td>{% if participant.rsvp == 1 %} Yes {% else %} No {% endif %}</td>

        <td><input class="form-control number-only form-control input-sm" id="inputHours_{{participant.user.username}}"
                   name="inputHours_{{participant.user.username}}" style="max-width: 90px;" type ="number" min="0" step="0.01"
                   {% if participant.attended == 1 %} value="{{participant.hoursEarned}}" {%else%} readonly {%endif%}></td>
      </tr>

      {%endfor%}
     </tbody>
      </table>
    </div>

    <div>
      <button type="submit" class="btn btn-primary float-end">Save</button>
    </div>

  </form>
{% include "addUserModal.html" %}
{% endblock %}
