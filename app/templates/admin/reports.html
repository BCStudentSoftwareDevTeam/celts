{% set title = "Download Reports" %} {% extends "base.html" %} {% block
app_content %}
<div class="download-container mt-50 text-center">
  <h1 class="mb-3">Annual Report</h1>
  <form method="post" action="/admin/reports/download" class="form-group col">
    <div
      class="d-flex flex-row text-center justify-content-evenly align-items-center"
    >
      <div class="container row-gap-3">
        <div class="row justify-content-center">
          <div class="col-4 mb-4">
            <select
              id="academicYear"
              name="academicYear"
              class="form-select"
              required
            >
              <option value="" disabled selected>
                Select an academic year
              </option>
              {% for year in academicYears %}
              <option value="{{ year }}">{{ year }}</option>
              {% endfor %}
            </select>
          </div>
          <div class="row justify-content-center">
            <div class="col-md-2 col-sm-2 d-flex flex-row justify-content-end">
              <button
                type="submit"
                class="btn btn-primary btn-m d-flex flex-row justify-content-center align-items-center"
                style="background-color: #214f95"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  x="0px"
                  y="0px"
                  width="20"
                  height="20"
                  viewBox="0 0 48 48"
                >
                  <defs>
                    <linearGradient
                      id="G7C1BuhajJQaEWHVlNUzHa_BEMhRoRy403e_gr1"
                      x1="6"
                      x2="27"
                      y1="24"
                      y2="24"
                      data-name="ÐÐµÐ·ÑÐ¼ÑÐ½Ð½ÑÐ¹ Ð³ÑÐ°Ð´Ð¸ÐµÐ½Ñ 10"
                      gradientUnits="userSpaceOnUse"
                    >
                      <stop offset="0" stop-color="#21ad64"></stop>
                      <stop offset="1" stop-color="#088242"></stop>
                    </linearGradient>
                  </defs>
                  <path
                    fill="#31c447"
                    d="m41,10h-16v28h16c.55,0,1-.45,1-1V11c0-.55-.45-1-1-1Z"
                  ></path>
                  <path
                    fill="#fff"
                    d="m32,15h7v3h-7v-3Zm0,10h7v3h-7v-3Zm0,5h7v3h-7v-3Zm0-10h7v3h-7v-3Zm-7-5h5v3h-5v-3Zm0,10h5v3h-5v-3Zm0,5h5v3h-5v-3Zm0-10h5v3h-5v-3Z"
                  ></path>
                  <path
                    fill="url(#G7C1BuhajJQaEWHVlNUzHa_BEMhRoRy403e_gr1)"
                    d="m27,42l-21-4V10l21-4v36Z"
                  ></path>
                  <path
                    fill="#fff"
                    d="m19.13,31l-2.41-4.56c-.09-.17-.19-.48-.28-.94h-.04c-.05.22-.15.54-.32.98l-2.42,4.52h-3.76l4.46-7-4.08-7h3.84l2,4.2c.16.33.3.73.42,1.18h.04c.08-.27.22-.68.44-1.22l2.23-4.16h3.51l-4.2,6.94,4.32,7.06h-3.74Z"
                  ></path>
                </svg>
                <p class="mb-0 py-0">Spreadsheet</p>
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  class="ml-1"
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                >
                  <path
                    d="M7 10l5 5 5-5"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
              </button>
            </div>
            <div class="col-md-2 d-flex flex-row justify-content-start">
              <button
                type="submit"
                class="d-flex flex-row justify-content-evenly align-items-center btn btn-m"
                style="background-color: #214f95; color: white"
              >
                <g fill="white" stroke="white">
                  <svg
                    width="24px"
                    height="24px"
                    viewBox="0 0 24 24"
                    stroke="currentcolor"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M21 21H7.8C6.11984 21 5.27976 21 4.63803 20.673C4.07354 20.3854 3.6146 19.9265 3.32698 19.362C3 18.7202 3 17.8802 3 16.2V3M15 10V17M7 13V17M19 5V17M11 7V17"
                      stroke="white"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                </g>
                <p class="mb-0 py-0">Charts</p>
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  class="ml-1"
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                >
                  <path
                    d="M7 10l5 5 5-5"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </form>
</div>

<!-- Chart.js Container -->
<div class="chart-container mt-5" style="width: 800px; margin: 0 auto">
  <canvas id="acquisitionsChart"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
<script type="module">
  import { getAquisitionsByYear } from "{{ url_for('static', filename='js/api.js') }}";

  (async function () {
    const data = await getAquisitionsByYear();

    new Chart(document.getElementById("acquisitionsChart"), {
      type: "bar",
      data: {
        labels: data.map((row) => row.year),
        datasets: [
          {
            label: "Acquisitions by year",
            data: data.map((row) => row.count),
            backgroundColor: "rgba(75, 192, 192, 0.2)",
            borderColor: "rgba(75, 192, 192, 1)",
            borderWidth: 1,
          },
        ],
      },
      options: {
        scales: {
          y: {
            beginAtZero: true,
          },
        },
      },
    });
  })();
</script>
{% endblock %}
